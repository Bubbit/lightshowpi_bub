#!/bin/bash
#
# Play audio files with synchronized lights.  Supports
# midi, mp3, wav, ogg, wma, etc...
#
# Sample Usage:
#
# play /home/pi/music/*
# play /home/pi/music/jingle_bells.mp3
#
# Author: Todd Giles (todd.giles@gmail.com)
# Modifications: Chris Usey (chris.usey@gmail.com)

# Check that the home environment variable is set
${SYNCHRONIZED_LIGHTS_HOME:?"Need to setup SYNCHRONIZED_LIGHTS_HOME environment variable, see readme"}

$SYNCHRONIZED_LIGHTS_HOME/bin/midi_off

for f in $@
do
  filename=$(basename "$f")
  extension="${f##*.}"
  if [ "$extension" = "mid" ]
  then
    play_midi "$f"
  else
    sudo python $SYNCHRONIZED_LIGHTS_HOME/py/synchronized_lights.py --file="$f"
  fi
done

$SYNCHRONIZED_LIGHTS_HOME/bin/lights_off
