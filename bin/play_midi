#!/bin/bash
#
# Play midi files with synchronized lights!
#
# Sample Usage:
#
#   play_midi /home/pi/music/midi/jingle_bells.mid
#   play_midi /home/pi/music/midi/*
#
# Author: Todd Giles (todd.giles@gmail.com)
# Modifications: Chris Usey (chris.usey@gmail.com)

# Check that the home environment variable is set
${SYNCHRONIZED_LIGHTS_HOME:?"Need to setup SYNCHRONIZED_LIGHTS_HOME environment variable, see readme"}

$SYNCHRONIZED_LIGHTS_HOME/bin/midi_on

for f in $@
do
  echo "Playing file: $f"
  aplaymidi --port=14 "$f"
done

$SYNCHRONIZED_LIGHTS_HOME/bin/midi_off
$SYNCHRONIZED_LIGHTS_HOME/bin/lights_off
